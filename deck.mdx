import {
  CodeSurfer,
  CodeSurferColumns,
  Step,
} from "code-surfer";
import { ultramin, vsDark, nightOwl, github } from "@code-surfer/themes";
import webTheory1 from "./slide-images/webtheory1.png"
import webTheory2 from "./slide-images/webtheory2.png"
import webTheory3 from "./slide-images/webtheory3.png"
import appOverview from "./slide-images/app_overview.png";
import appOverview3 from "./slide-images/app_overview_step_3.png";
import productListImage from "./slide-images/productList.png"
import productItemImage from "./slide-images/productItem.png"
export const theme = ultramin;

<Head>
  <title>.Hack Vue Composition Workshop</title>
</Head>

# Vue Composition Workshop

---

# About Myself
- Hi I'm Arix
- SMU Alumi
- Previous VP and Hon Gen for .Hack
- Software Engineer at NinjaVan ðŸšš

---

# Agenda

1. Web Theory
2. What is Composition API
3. Why should I learn it
4. Comparing Composition and Options API

---

# Web Theory

---

# Web hosting in the past

<Image src={webTheory1} style={{"width": "80vw", "background-size": "auto"}} />

---

# Server Side Rendering

<Image src={webTheory2} style={{"width": "80vw", "background-size": "auto"}} />

---

# Client Side Rendering / Single Page Applications

<Image src={webTheory3} style={{"width": "80vw", "background-size": "auto"}} />

---

# Any Questions?

---

# Vue Composition Api

---

# What is Composition API
- Release with Vue 3.0
- New way to write vue components
- Inspired by React Hooks
- Aim towards large-scale vue projects
- Simplify components and improve maintainability

---

# Why should I learn it
- Vue getting more popular in SG
- Keep components more readable
- Can be used with Options API
- Better Typescript support
- Easier transition to React

---

# Comparing Composition and Options API

---

# Example Application

<Image src={appOverview} style={{width: "80vw", backgroundSize: "contain"}} />

---

<CodeSurferColumns themes={[github, nightOwl]}>

<Step subtitle="App.vue">

<Image src={appOverview3} style={{backgroundSize: "contain"}} />

```jsx file=./project/options/src/app.vue showNumbers
```

</Step>

<Step>

<Image src={appOverview3} style={{backgroundSize: "contain"}} />

```jsx 1:21 file=./project/options/src/app.vue showNumbers
```

</Step>

<Step>

<Image src={appOverview3} style={{backgroundSize: "contain"}} />

```diff 19 subtitle="Look into this component first"
```

</Step>

</CodeSurferColumns>

---

<CodeSurferColumns themes={[github, nightOwl]}>

<Step subtitle="ProductList.vue">

<Image src={productListImage} style={{backgroundSize: "contain"}} />

```jsx file=./project/options/src/components/Products/ProductList.vue showNumbers
```

</Step>

<Step subtitle='Template markup will remain the same between options and composition implementation'>

<Image src={productListImage} style={{backgroundSize: "contain"}} />

```jsx 1:7 file=./project/options/src/components/Products/ProductList.vue showNumbers
```

</Step>

<Step subtitle="Look into how the component is implemented with options api">

<Image src={productListImage} style={{backgroundSize: "contain"}} />

```jsx 9:23 file=./project/options/src/components/Products/ProductList.vue showNumbers
```

</Step>

<Step subtitle='Import statements'>

<Image src={productListImage} style={{backgroundSize: "contain"}} />

```diff 10:11
```

</Step>

<Step subtitle='Vue instance object'>

<Image src={productListImage} style={{backgroundSize: "contain"}} />

```diff 13:22
```

</Step>

<Step subtitle='Component declarations'>

<Image src={productListImage} style={{backgroundSize: "contain"}} />

```diff 14:18
```

</Step>

<Step subtitle='Props Declaration'>

<Image src={productListImage} style={{backgroundSize: "contain"}} />

```diff 19:21
```

</Step>

<Step>

<Image src={productListImage} style={{backgroundSize: "contain"}} />

```jsx 9:23 file=./project/options/src/components/Products/ProductList.vue showNumbers title='Options API'
```

</Step>

</CodeSurferColumns>

---

<CodeSurferColumns themes={[vsDark, nightOwl]}>

<Step>

```jsx 1:14 file=./project/composition/src/components/Products/ProductList.vue showNumbers title='Composition API'
```

```jsx 9:23 file=./project/options/src/components/Products/ProductList.vue showNumbers title='Options API'
```

</Step>

<Step>

```jsx 1 file=./project/composition/src/components/Products/ProductList.vue showNumbers title='Composition API' subtitle='Script declared with setup and typescript'
```

```jsx 9 file=./project/options/src/components/Products/ProductList.vue showNumbers title='Options API'
```

</Step>

<Step subtitle='Import statements'>

```diff 2:5 title='Composition API'
```

```jsx 10:11 file=./project/options/src/components/Products/ProductList.vue showNumbers title='Options API'
```

</Step>

<Step>

```diff 2:5 title='Composition API' subtitle='No need to declare components'
```

```jsx 14:18 file=./project/options/src/components/Products/ProductList.vue showNumbers title='Options API'
```

</Step>

<Step subtitle='Props Declaration'>

```diff 7:13 title='Composition API'
```

```jsx 19:21 file=./project/options/src/components/Products/ProductList.vue showNumbers title='Options API'
```

</Step>

<Step subtitle='Look into ProductItem Component'>

```diff 19 title='Composition API'
```

```diff 4 title='Options API'
```

</Step>

</CodeSurferColumns>

---

<CodeSurferColumns themes={[nightOwl, github, nightOwl]}>

<Step subtitle="ProductItem.vue">

```jsx 22:39 file=./project/composition/src/components/Products/ProductItem.vue showNumbers title='Composition API'
```

<Image src={productItemImage} style={{backgroundSize: "contain"}} />

```jsx 1:18 file=./project/options/src/components/Products/ProductItem.vue showNumbers title='Options API'
```

</Step>

<Step subtitle="Component Styling">

```diff 41:51 showNumbers title='Composition API'
```

<Image src={productItemImage} style={{backgroundSize: "contain"}} />

```diff 35:45 title='Options API'
```

</Step>

<Step>

```diff 1:20 title='Composition API'
```

<Image src={productItemImage} style={{backgroundSize: "contain"}} />

```diff 20:33 file=./project/options/src/components/Products/ProductItem.vue showNumbers title='Options API'
```

</Step>

</CodeSurferColumns>

---

<CodeSurferColumns themes={[github, nightOwl]}>

<Step subtitle="Back to App.vue">

<Image src={appOverview3} style={{backgroundSize: "contain"}} />

```jsx file=./project/options/src/app.vue showNumbers
```

</Step>

<Step>

<Image src={appOverview3} style={{backgroundSize: "contain"}} />

```jsx 1:21 file=./project/options/src/app.vue showNumbers
```

</Step>

<Step>

<Image src={appOverview3} style={{backgroundSize: "contain"}} />

```diff 5:8 subtitle="Next we will look at the ProductSearchInput Component"
```

</Step>

<Step>

<Image src={appOverview3} style={{backgroundSize: "contain"}} />

```diff 6:7  showNumbers subtitle="Binding 'searchTerm' data state and adding a 'triggerSearch' event handler"
```

</Step>

<Step>

<Image src={appOverview3} style={{backgroundSize: "contain"}} />

```diff 5:8 subtitle="Child component should update 'searchTerm' state in parent and emit 'triggerSearch' event"
```

</Step>

</CodeSurferColumns>

---

<CodeSurferColumns themes={[vsDark, nightOwl]}>

<Step>

```jsx file=./project/options/src/components/Products/ProductSearchInput.vue showNumbers title="ProductSearchInput.vue"
```

```jsx 5:8 file=./project/options/src/app.vue showNumbers title="App.vue"
```

</Step>

<Step>

```jsx 4:11,28:31 file=./project/options/src/components/Products/ProductSearchInput.vue title="ProductSearchInput.vue" subtitle='ProductSearchInput keeps track of its own input'
```

```jsx 5:8 file=./project/options/src/app.vue showNumbers title="App.vue"
```

</Step>

<Step>

```diff 6 title="ProductSearchInput.vue" subtitle='Emits an update to the parent whenever it changes'
```

```jsx 5:8 file=./project/options/src/app.vue showNumbers title="App.vue"
```

</Step>

<Step>

```diff 6 title="ProductSearchInput.vue" subtitle='Emits an update to the parent whenever it changes'
```

```jsx 6 file=./project/options/src/app.vue showNumbers title="App.vue" subtitle="Parent catches the emit event and update the state of 'searchTerm'"
```

</Step>

<Step>

```diff 2,12:13 title="ProductSearchInput.vue" subtitle="emit 'triggerSearch' event whenever form is submitted or search button is clicked"
```

```jsx 7 file=./project/options/src/app.vue showNumbers title="App.vue"
```

</Step>

<Step>

```diff 2,12:13 title="ProductSearchInput.vue" subtitle="emit 'triggerSearch' event whenever form is submitted or search button is clicked"
```

```jsx 7 file=./project/options/src/app.vue showNumbers title="App.vue" subtitle="Parent catches emit and calls the handleSearch function"
```

</Step>

<Step>

```diff 2,12:13 title="ProductSearchInput.vue" subtitle="emit 'triggerSearch' event whenever form is submitted or search button is clicked"
```

```jsx 58:60 file=./project/options/src/app.vue showNumbers title="App.vue" subtitle="handleSearch calls the API with new searchTerm value"
```

</Step>

<Step>

```jsx file=./project/options/src/components/Products/ProductSearchInput.vue showNumbers title="ProductSearchInput.vue"
```

```jsx file=./project/options/src/app.vue showNumbers title="App.vue"
```

</Step>

</CodeSurferColumns>

---

<CodeSurferColumns themes={[vsDark, nightOwl]}>

<Step subtitle="ProductSearchInput.vue">

```jsx file=./project/options/src/components/Products/ProductSearchInput.vue showNumbers title="Options API"
```

```jsx file=./project/composition/src/components/Products/ProductSearchInput.vue showNumbers title="Composition API"
```

</Step>

<Step>

```diff 19:34 title="Options API"
```

```diff 1:5 title="Composition API"
```

</Step>

<Step subtitle='Data option is condensed to a single line'>

```diff 28:32 title="Options API"
```

```diff 3:4 title="Composition API"
```

</Step>

</CodeSurferColumns>

---

<CodeSurferColumns themes={[nightOwl]}>

<Step>

```jsx file=./project/options/src/app.vue showNumbers title="App.vue" showNumbers
```

</Step>

<Step>

```diff 1:21 title="App.vue"
```

</Step>

<Step>

```diff 9:13 title="App.vue" subtitle='multiple v-models with colon syntax'
```

</Step>

<Step>

```diff 23:72 title="App.vue"
```

</Step>

<Step>

```diff 23:31 title="App.vue" subtitle='Import statements'
```

</Step>

<Step>

```diff 34:36 title="App.vue"  subtitle='Component declarations that is not required in composition implementation'
```

</Step>

<Step>

```diff 37:45 title="App.vue" subtitle='Data object where we manage the state of our component'
```

</Step>

<Step>

```diff 46:48 title="App.vue" subtitle='Mounted lifecycle function'
```

</Step>

<Step>

```diff 49:56 title="App.vue" subtitle='Watcher functions to trigger events when a state changes'
```

</Step>

<Step>

```diff 57:72 title="App.vue" subtitle='Component functions'
```

</Step>

<Step subtitle="Instead of comparing the two code bases. let's just rebuild App.vue with the Composition API">

```diff 23:72 title="App.vue"
```

</Step>

</CodeSurferColumns>

---

<CodeSurferColumns themes={[nightOwl, vsDark]}>

<Step subtitle='Starting with the template as our base'>

```jsx 1:21 file=./project/options/src/app.vue showNumbers title='Options API'
```

```jsx file=./slide-code/App0.vue showNumbers title='Composition API'
```

</Step>

<Step subtitle='We want to achieve the same functionality with Composition API'>

```jsx 23:72 file=./project/options/src/app.vue showNumbers title='Options API'
```

```jsx file=./slide-code/App1.vue showNumbers title='Composition API'
```

</Step>

<Step subtitle='We start with the component imports required for the page'>

```jsx 23:72 file=./project/options/src/app.vue showNumbers title='Options API'
```

```jsx file=./slide-code/App2.vue showNumbers title='Composition API'
```

</Step>

<Step subtitle='Next we need to manage the state of searchTerm within our component'>

```jsx 23:72 file=./project/options/src/app.vue showNumbers title='Options API'
```

```jsx 16 file=./slide-code/App2.vue showNumbers title='Composition API'
```

</Step>

<Step subtitle='We will use a ref for to manage this'>

```jsx 23:72 file=./project/options/src/app.vue showNumbers title='Options API'
```

```jsx file=./slide-code/App3.vue showNumbers title='Composition API'
```

</Step>

<Step subtitle='By declaring this, we will be able to use searchTerm within our template'>

```jsx 23:72 file=./project/options/src/app.vue showNumbers title='Options API'
```

```jsx 11,19 file=./slide-code/App3.vue showNumbers title='Composition API'
```

</Step>

<Step subtitle='*Note* that ref is external module that we import. data() will always be tied to a component'>

```jsx 37:45 file=./project/options/src/app.vue showNumbers title='Options API'
```

```jsx 2 file=./slide-code/App3.vue showNumbers title='Composition API'
```

</Step>

<Step subtitle='This means reactive state is no longer bounded to the scope of a vue component anymore and we can create reactive code anywhere'>

```jsx 37:45 file=./project/options/src/app.vue showNumbers title='Options API'
```

```jsx 2,11 file=./slide-code/App3.vue showNumbers title='Composition API'
```

</Step>

</CodeSurferColumns>

---

<CodeSurferColumns themes={[nightOwl]}>

<Step>

```js title="useProducts.ts" showNumbers subtitle="Let's create create the state for products"
```

</Step>

<Step>

```js title="useProducts.ts" subtitle='First we import ref, our product type and our api helper'
import { ref } from 'vue'
import { ProductProp } from '@/types/products'
import api from '@/api'
```

</Step>

<Step>

```js title="useProducts.ts" subtitle='Allow our states to be imported from other files'
import { ref } from 'vue'
import { ProductProp } from '@/types/products'
import api from '@/api'

export default function useProducts(){

    return {

    }
}
```

</Step>

<Step>

```js title="useProducts.ts" subtitle='Declare products and isLoadingProducts states'
import { ref } from 'vue'
import { ProductProp } from '@/types/products'
import api from '@/api'

export default function useProducts(){
    const products = ref<Array<ProductProp>>([])
    const isLoadingProducts = ref<boolean>(false)

    return {
        isLoadingProducts,
        products,
    }
}
```

</Step>

<Step>

```js title="useProducts.ts" subtitle='Declare getProducts method'
import { ref } from 'vue'
import { ProductProp } from '@/types/products'
import api from '@/api'

export default function useProducts(){
    const products = ref<Array<ProductProp>>([])
    const isLoadingProducts = ref<boolean>(false)

    const getProducts = async (
        searchTerm: string,
        brands: Array<string>,
        categories: Array<string>
    ): Promise<Array<ProductProp>> => {
        isLoadingProducts.value = true
        const data = await api.getProducts(searchTerm, brands, categories)
        products.value = data
        isLoadingProducts.value = false
        return data
    }

    return {
        isLoadingProducts,
        products,
        getProducts,
    }
}
```

</Step>

<Step>

```js title="useProducts.ts" subtitle='You have created your first composable'
import { ref } from 'vue'
import { ProductProp } from '@/types/products'
import api from '@/api'

export default function useProducts(){
    const products = ref<Array<ProductProp>>([])
    const isLoadingProducts = ref<boolean>(false)

    const getProducts = async (
        searchTerm: string,
        brands: Array<string>,
        categories: Array<string>
    ): Promise<Array<ProductProp>> => {
        isLoadingProducts.value = true
        const data = await api.getProducts(searchTerm, brands, categories)
        products.value = data
        isLoadingProducts.value = false
        return data
    }

    return {
        isLoadingProducts,
        products,
        getProducts,
    }
}
```

</Step>

</CodeSurferColumns>

---

<CodeSurferColumns themes={[nightOwl, vsDark]}>

<Step subtitle='Back to App.vue'>

```jsx 23:72 file=./project/options/src/app.vue showNumbers title='Options API'
```

```jsx 1:12 file=./slide-code/App3.vue showNumbers title='Composition API'
```

</Step>

<Step subtitle="Let's import and use our new composable">

```jsx 40,41,61:65 file=./project/options/src/app.vue showNumbers title='Options API'
```

```jsx file=./slide-code/App4.vue showNumbers title='Composition API'
```

</Step>

<Step subtitle="We can do the same for the brand and category states for our filter">

```jsx 42,43,66:69 file=./project/options/src/app.vue showNumbers title='Options API'
```

```jsx file=./slide-code/App5.vue showNumbers title='Composition API'
```

</Step>

<Step subtitle="Declare handleSearch function">

```jsx 58:60 file=./project/options/src/app.vue showNumbers title='Options API'
```

```jsx file=./slide-code/App6.vue showNumbers title='Composition API'
```

</Step>

<Step subtitle="Import onMounted and watch modules">

```jsx 46:56 file=./project/options/src/app.vue showNumbers title='Options API'
```

```jsx file=./slide-code/App7.vue showNumbers title='Composition API'
```

</Step>

<Step subtitle="Declare mounted lifecycle hook and watchers">

```jsx 46:56 file=./project/options/src/app.vue showNumbers title='Options API'
```

```jsx file=./slide-code/App8.vue showNumbers title='Composition API'
```

</Step>

<Step subtitle="Final comparison">

```jsx 23:72 file=./project/options/src/app.vue showNumbers title='Options API'
```

```jsx 1:24 file=./slide-code/App8.vue showNumbers title='Composition API'
```

</Step>

</CodeSurferColumns>

---

# Any Questions?

---

# Thank you!